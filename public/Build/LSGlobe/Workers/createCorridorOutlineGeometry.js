define(["./defaultValue-bcb5baf7","./DeveloperError-b273b01a","./Check-f9a1a1be","./Math-588d98f6","./Cartesian2-10213add","./Rectangle-de996bfb","./Transforms-2b063051","./Matrix4-c981b715","./RuntimeError-1b5fbc4d","./WebGLConstants-667a4a5e","./ComponentDatatype-ec1abf38","./GeometryAttribute-49fe2445","./when-ae2a7552","./buildModuleUrl-cd6b3599","./GeometryAttributes-a8cf4ac9","./IndexDatatype-523f50d6","./IntersectionTests-cc1722b0","./Plane-bb97f210","./GeometryOffsetAttribute-a79c4b79","./arrayRemoveDuplicates-f05ed775","./EllipsoidTangentPlane-86347fa6","./EllipsoidRhumbLine-b25fd372","./PolygonPipeline-bd17f470","./PolylineVolumeGeometryLibrary-a52c795b","./EllipsoidGeodesic-8f6c0327","./PolylinePipeline-74d8353e","./CorridorGeometryLibrary-85d09348"],function(R,e,t,u,S,h,p,r,i,o,U,B,a,n,F,Y,s,l,v,f,d,y,A,q,c,b,W){"use strict";var J=new S.Cartesian3,j=new S.Cartesian3,z=new S.Cartesian3;function _(e,t){var r,i=[],o=e.positions,a=e.corners,n=e.endPositions,s=new F.GeometryAttributes,l=0,d=0,u=0;for(w=0;w<o.length;w+=2)l+=r=o[w].length-3,u+=r/3*4,d+=o[w+1].length-3;for(l+=3,d+=3,w=0;w<a.length;w++){x=a[w];var p=a[w].leftPositions;R.defined(p)?l+=r=p.length:d+=r=a[w].rightPositions.length,u+=r/3*2}var f,h=R.defined(n);h&&(l+=f=n[0].length-3,d+=f,u+=4*(f/=3));var y,c,b,g,m,v,e=l+d,A=new Float64Array(e),_=0,E=e-1,C=f/2,G=Y.IndexDatatype.createTypedArray(e/3,u+4),T=0;if(G[T++]=_/3,G[T++]=(E-2)/3,h){i.push(_/3),v=J,m=j;for(var P=n[0],w=0;w<C;w++)v=S.Cartesian3.fromArray(P,3*(C-1-w),v),m=S.Cartesian3.fromArray(P,3*(C+w),m),W.CorridorGeometryLibrary.addAttribute(A,m,_),W.CorridorGeometryLibrary.addAttribute(A,v,void 0,E),g=(c=_/3)+1,b=(y=(E-2)/3)-1,G[T++]=y,G[T++]=b,G[T++]=c,G[T++]=g,_+=3,E-=3}var L=0,D=o[L++],k=o[L++];for(A.set(D,_),A.set(k,E-k.length+1),r=k.length-3,i.push(_/3,(E-2)/3),w=0;w<r;w+=3)g=(c=_/3)+1,b=(y=(E-2)/3)-1,G[T++]=y,G[T++]=b,G[T++]=c,G[T++]=g,_+=3,E-=3;for(w=0;w<a.length;w++){var V,x,N,O=(x=a[w]).leftPositions,H=x.rightPositions,I=z;if(R.defined(O)){for(E-=3,N=b,i.push(g),V=0;V<O.length/3;V++)I=S.Cartesian3.fromArray(O,3*V,I),G[T++]=N-V-1,G[T++]=N-V,W.CorridorGeometryLibrary.addAttribute(A,I,void 0,E),E-=3;i.push(N-Math.floor(O.length/6)),t===q.CornerType.BEVELED&&i.push((E-2)/3+1),_+=3}else{for(_+=3,N=g,i.push(b),V=0;V<H.length/3;V++)I=S.Cartesian3.fromArray(H,3*V,I),G[T++]=N+V,G[T++]=N+V+1,W.CorridorGeometryLibrary.addAttribute(A,I,_),_+=3;i.push(N+Math.floor(H.length/6)),t===q.CornerType.BEVELED&&i.push(_/3-1),E-=3}for(D=o[L++],k=o[L++],D.splice(0,3),k.splice(k.length-3,3),A.set(D,_),A.set(k,E-k.length+1),r=k.length-3,V=0;V<k.length;V+=3)c=(g=_/3)-1,y=(b=(E-2)/3)+1,G[T++]=y,G[T++]=b,G[T++]=c,G[T++]=g,_+=3,E-=3;_-=3,E+=3,i.push(_/3,(E-2)/3)}if(h){_+=3,E-=3,v=J,m=j;var M=n[1];for(w=0;w<C;w++)v=S.Cartesian3.fromArray(M,3*(f-w-1),v),m=S.Cartesian3.fromArray(M,3*w,m),W.CorridorGeometryLibrary.addAttribute(A,v,void 0,E),W.CorridorGeometryLibrary.addAttribute(A,m,_),c=(g=_/3)-1,y=(b=(E-2)/3)+1,G[T++]=y,G[T++]=b,G[T++]=c,G[T++]=g,_+=3,E-=3;i.push(_/3)}else i.push(_/3,(E-2)/3);return G[T++]=_/3,G[T++]=(E-2)/3,s.position=new B.GeometryAttribute({componentDatatype:U.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:A}),{attributes:s,indices:G,wallIndices:i}}function g(e){var t=(e=R.defaultValue(e,R.defaultValue.EMPTY_OBJECT)).positions,r=e.width,i=R.defaultValue(e.height,0),o=R.defaultValue(e.extrudedHeight,i);this._positions=t,this._ellipsoid=h.Ellipsoid.clone(R.defaultValue(e.ellipsoid,h.Ellipsoid.WGS84)),this._width=r,this._height=Math.max(i,o),this._extrudedHeight=Math.min(i,o),this._cornerType=R.defaultValue(e.cornerType,q.CornerType.ROUNDED),this._granularity=R.defaultValue(e.granularity,u.CesiumMath.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*S.Cartesian3.packedLength+h.Ellipsoid.packedLength+6}g.pack=function(e,t,r){r=R.defaultValue(r,0);var i=e._positions,o=i.length;t[r++]=o;for(var a=0;a<o;++a,r+=S.Cartesian3.packedLength)S.Cartesian3.pack(i[a],t,r);return h.Ellipsoid.pack(e._ellipsoid,t,r),r+=h.Ellipsoid.packedLength,t[r++]=e._width,t[r++]=e._height,t[r++]=e._extrudedHeight,t[r++]=e._cornerType,t[r++]=e._granularity,t[r]=R.defaultValue(e._offsetAttribute,-1),t};var m=h.Ellipsoid.clone(h.Ellipsoid.UNIT_SPHERE),E={positions:void 0,ellipsoid:m,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};return g.unpack=function(e,t,r){t=R.defaultValue(t,0);for(var i=e[t++],o=new Array(i),a=0;a<i;++a,t+=S.Cartesian3.packedLength)o[a]=S.Cartesian3.unpack(e,t);var n=h.Ellipsoid.unpack(e,t,m);t+=h.Ellipsoid.packedLength;var s=e[t++],l=e[t++],d=e[t++],u=e[t++],p=e[t++],f=e[t];return R.defined(r)?(r._positions=o,r._ellipsoid=h.Ellipsoid.clone(n,r._ellipsoid),r._width=s,r._height=l,r._extrudedHeight=d,r._cornerType=u,r._granularity=p,r._offsetAttribute=-1===f?void 0:f,r):(E.positions=o,E.width=s,E.height=l,E.extrudedHeight=d,E.cornerType=u,E.granularity=p,E.offsetAttribute=-1===f?void 0:f,new g(E))},g.createGeometry=function(e){var t=e._positions,r=e._width,i=e._ellipsoid,t=function(e,t){for(var r=0;r<e.length;r++)e[r]=t.scaleToGeodeticSurface(e[r],e[r]);return e}(t,i),o=f.arrayRemoveDuplicates(t,S.Cartesian3.equalsEpsilon);if(!(o.length<2||r<=0)){var a,n=e._height,s=e._extrudedHeight,t=!u.CesiumMath.equalsEpsilon(n,s,0,u.CesiumMath.EPSILON2),r={ellipsoid:i,positions:o,width:r,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1};t?(r.height=n,r.extrudedHeight=s,r.offsetAttribute=e._offsetAttribute,a=function(e){var t=e.ellipsoid,r=(l=_(W.CorridorGeometryLibrary.computePositions(e),e.cornerType)).wallIndices,i=e.height,o=e.extrudedHeight,a=l.attributes,n=l.indices,s=(d=a.position.values).length;(u=new Float64Array(s)).set(d);var l=new Float64Array(2*s),d=A.PolygonPipeline.scaleToGeodeticHeight(d,i,t),u=A.PolygonPipeline.scaleToGeodeticHeight(u,o,t);l.set(d),l.set(u,s),a.position.values=l,s/=3,R.defined(e.offsetAttribute)&&(u=new Uint8Array(2*s),u=e.offsetAttribute===v.GeometryOffsetAttribute.TOP?v.arrayFill(u,1,0,s):(e=e.offsetAttribute===v.GeometryOffsetAttribute.NONE?0:1,v.arrayFill(u,e)),a.applyOffset=new B.GeometryAttribute({componentDatatype:U.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:u}));var p=n.length,f=Y.IndexDatatype.createTypedArray(l.length/3,2*(p+r.length));f.set(n);for(var h,y,c=p,b=0;b<p;b+=2){var g=n[b],m=n[b+1];f[c++]=g+s,f[c++]=m+s}for(b=0;b<r.length;b++)y=(h=r[b])+s,f[c++]=h,f[c++]=y;return{attributes:a,indices:f}}(r)):((a=_(W.CorridorGeometryLibrary.computePositions(r),r.cornerType)).attributes.position.values=A.PolygonPipeline.scaleToGeodeticHeight(a.attributes.position.values,n,i),R.defined(e._offsetAttribute)&&(l=a.attributes.position.values.length,d=new Uint8Array(l/3),l=e._offsetAttribute===v.GeometryOffsetAttribute.NONE?0:1,v.arrayFill(d,l),a.attributes.applyOffset=new B.GeometryAttribute({componentDatatype:U.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:d})));var l=a.attributes,d=p.BoundingSphere.fromVertices(l.position.values,void 0,3);return new B.Geometry({attributes:l,indices:a.indices,primitiveType:B.PrimitiveType.LINES,boundingSphere:d,offsetAttribute:e._offsetAttribute})}},function(e,t){return R.defined(t)&&(e=g.unpack(e,t)),e._ellipsoid=h.Ellipsoid.clone(e._ellipsoid),g.createGeometry(e)}});
