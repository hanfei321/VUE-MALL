define(["./defaultValue-bcb5baf7","./when-ae2a7552"],function(o,n){"use strict";return function(r){var f;return function(e){var a=e.data,s=[],i={id:a.id,result:void 0,error:void 0};return n.when(function(e,r,t){try{return e(r,t)}catch(e){return n.when.reject(e)}}(r,a.parameters,s)).then(function(e){i.result=e}).otherwise(function(e){e instanceof Error?i.error={name:e.name,message:e.message,stack:e.stack}:i.error=e}).always(function(){o.defined(f)||(f=o.defaultValue(self.webkitPostMessage,self.postMessage)),a.canTransferArrayBuffer||(s.length=0);try{f(i,s)}catch(e){i.result=void 0,i.error="postMessage failed with error: "+(t=(r=e).name,n=r.message,n=o.defined(t)&&o.defined(n)?t+": "+n:r.toString(),r=r.stack,o.defined(r)&&(n+="\n"+r),n)+"\n  with responseMessage: "+JSON.stringify(i),f(i)}var r,t,n})}}});
