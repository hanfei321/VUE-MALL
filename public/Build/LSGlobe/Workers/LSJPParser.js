define(["./LSJPNode","./LSJPNodeMat","./LSJPNodeMesh"],function(w,p,F){"use strict";function r(){}return r.parse=function(r,e){e.readUInt32();!function(r,e){for(var a=e.readUInt32(),n=0;n<a;n++){var t=new p;t.index=n,t.id=n,r.arryMaterials.push(t);var d=e.readUChar8Array2(4),i=e.readUChar8Array2(4);e.readUChar8Array2(4),e.readFloat();t.diffuseR=d[0]/255*i[0]/255,t.diffuseG=d[1]/255*i[1]/255,t.diffuseB=d[2]/255*i[2]/255;for(var o=e.readUInt32(),s=0;s<o;s++)if(0==e.readUInt32()){var f=e.readString();if(0==s){var l,U=f.substring(f.lastIndexOf("."),f.length).toLowerCase();if(".jpeg"==U||".jpg"==U)l="jpeg";else if(".png"==U)l="png";else if(".gif"==U)l="gif";else if(".icon"==U)l="x-icon";else if(".dxt"==U||".etc"==U||".pvr"==U){l="compressed";var u=e.readUInt32(),f=e.readUInt32(),U=e.readUInt32(),I=e.readUInt32(),h=e.readUChar8Array2(u-12);t.width=f,t.height=U,t.pixelFormat=I,t.imgBlob=h,t.eftype=l,t.bUrl=!1;continue}u=e.readUInt32(),h=e.readUChar8Array2(u);t.imgBlob=new Blob([h],{type:l}),t.bUrl=!1}}else{I=e.readString();0==s&&(t.imgUrl=I,t.bUrl=!0)}}}(r,e),function r(e,a){for(var n=a.readUInt32(),t=0;t<n;t++){var d=a.readUInt32(),i=new w;e.children.push(i),0==d?i.strDataPath=a.readString():r(i,a)}e.enRangeMode=a.readUInt32();var o=a.readUInt32(),t=0,s=0;for(t=0;t<o;t++)e.childRanges.push(a.readDouble()),e.childRanges.push(a.readDouble());e.bdSphere.push(a.readDouble()),e.bdSphere.push(a.readDouble()),e.bdSphere.push(a.readDouble()),e.bdSphere.push(a.readDouble());var f=a.readUInt32();for(t=0;t<f;t++){var l=new F;e.nodeMeshes.push(l),l.matIndex=a.readInt32(),a.readUInt32();var U=a.readUInt32();if(0<U){var u=a.readUInt32();if(4==u){var I=a.readUInt32Array(U);for(l.indices=new Uint32Array(U),s=0;s<U;s++)l.indices[s]=I.getUint32(4*s,!0)}else if(2==u)for(I=a.readUInt16Array(U),l.indices=new Uint16Array(U),s=0;s<U;s++)l.indices[s]=I.getUint16(2*s,!0)}if(0<(u=a.readUInt32())){var h=3*u,p=a.readFloat32Array(h);for(l.verts=new Float32Array(h),s=0;s<h;s++)l.verts[s]=p.getFloat32(4*s,!0)}if(0<(u=a.readUInt32())){var h=3*u,g=a.readFloat32Array(h);for(l.normals=new Float32Array(h),s=0;s<h;s++)l.normals[s]=g.getFloat32(4*s,!0)}for(var v=a.readUInt32(),c=0;c<v;c++){var y=a.readUInt32();if(0<y){for(var h=2*y,b=a.readFloat32Array(h),A=new Float32Array(h),s=0;s<h;s++)A[s]=b.getFloat32(4*s,!0);l.uvs.push(A)}}if(0<(u=a.readUInt32()))for(h=u,l.colors=new Uint32Array(h),l.colorPerNum=1,s=0;s<h;s++)l.colors[s]=a.readUInt32();0<(u=a.readUInt32())&&(h=u,a.readUInt32Array(h))}}(r,e)},r});
