define(["exports","./defaultValue-bcb5baf7","./DeveloperError-b273b01a","./Check-f9a1a1be","./Math-588d98f6","./Cartesian2-10213add","./Rectangle-de996bfb","./Transforms-2b063051","./Matrix4-c981b715","./Plane-bb97f210","./EllipsoidTangentPlane-86347fa6"],function(a,y,t,e,w,O,b,o,P,N,A){"use strict";function T(a,t){this.center=O.Cartesian3.clone(y.defaultValue(a,O.Cartesian3.ZERO)),this.halfAxes=P.Matrix3.clone(y.defaultValue(t,P.Matrix3.ZERO))}T.packedLength=O.Cartesian3.packedLength+P.Matrix3.packedLength,T.pack=function(a,t,e){return e=y.defaultValue(e,0),O.Cartesian3.pack(a.center,t,e),P.Matrix3.pack(a.halfAxes,t,e+O.Cartesian3.packedLength),t},T.unpack=function(a,t,e){return t=y.defaultValue(t,0),y.defined(e)||(e=new T),O.Cartesian3.unpack(a,t,e.center),P.Matrix3.unpack(a,t+O.Cartesian3.packedLength,e.halfAxes),e};var R=new O.Cartesian3,E=new O.Cartesian3,I=new O.Cartesian3,L=new O.Cartesian3,z=new O.Cartesian3,S=new O.Cartesian3,U=new P.Matrix3,V={unitary:new P.Matrix3,diagonal:new P.Matrix3};T.fromPoints=function(a,t){if(y.defined(t)||(t=new T),!y.defined(a)||0===a.length)return t.halfAxes=P.Matrix3.ZERO,t.center=O.Cartesian3.ZERO,t;for(var e=a.length,n=O.Cartesian3.clone(a[0],R),r=1;r<e;r++)O.Cartesian3.add(n,a[r],n);var i=1/e;O.Cartesian3.multiplyByScalar(n,i,n);var s,o=0,C=0,c=0,u=0,l=0,d=0;for(r=0;r<e;r++)o+=(s=O.Cartesian3.subtract(a[r],n,E)).x*s.x,C+=s.x*s.y,c+=s.x*s.z,u+=s.y*s.y,l+=s.y*s.z,d+=s.z*s.z;o*=i,C*=i,c*=i,u*=i,l*=i,d*=i;i=U;i[0]=o,i[1]=C,i[2]=c,i[3]=C,i[4]=u,i[5]=l,i[6]=c,i[7]=l,i[8]=d;var i=P.Matrix3.computeEigenDecomposition(i,V),i=P.Matrix3.clone(i.unitary,t.halfAxes),h=P.Matrix3.getColumn(i,0,L),x=P.Matrix3.getColumn(i,1,z),M=P.Matrix3.getColumn(i,2,S),m=-Number.MAX_VALUE,f=-Number.MAX_VALUE,p=-Number.MAX_VALUE,g=Number.MAX_VALUE,w=Number.MAX_VALUE,b=Number.MAX_VALUE;for(r=0;r<e;r++)s=a[r],m=Math.max(O.Cartesian3.dot(h,s),m),f=Math.max(O.Cartesian3.dot(x,s),f),p=Math.max(O.Cartesian3.dot(M,s),p),g=Math.min(O.Cartesian3.dot(h,s),g),w=Math.min(O.Cartesian3.dot(x,s),w),b=Math.min(O.Cartesian3.dot(M,s),b);h=O.Cartesian3.multiplyByScalar(h,.5*(g+m),h),x=O.Cartesian3.multiplyByScalar(x,.5*(w+f),x),M=O.Cartesian3.multiplyByScalar(M,.5*(b+p),M);i=O.Cartesian3.add(h,x,t.center);O.Cartesian3.add(i,M,i);i=I;return i.x=m-g,i.y=f-w,i.z=p-b,O.Cartesian3.multiplyByScalar(i,.5,i),P.Matrix3.multiplyByScale(t.halfAxes,i,t.halfAxes),t};var d=new O.Cartesian3,h=new O.Cartesian3;function v(a,t,e,n,r,i,s,o,C,c,u){y.defined(u)||(u=new T);var l=u.halfAxes;P.Matrix3.setColumn(l,0,t,l),P.Matrix3.setColumn(l,1,e,l),P.Matrix3.setColumn(l,2,n,l),(e=d).x=(r+i)/2,e.y=(s+o)/2,e.z=(C+c)/2;n=h;n.x=(i-r)/2,n.y=(o-s)/2,n.z=(c-C)/2;C=u.center,e=P.Matrix3.multiplyByVector(l,e,e);return O.Cartesian3.add(a,e,C),P.Matrix3.multiplyByScale(l,n,l),u}var B=new O.Cartographic,_=new O.Cartesian3,k=new O.Cartographic,W=new O.Cartographic,D=new O.Cartographic,q=new O.Cartographic,X=new O.Cartographic,j=new O.Cartesian3,Z=new O.Cartesian3,G=new O.Cartesian3,F=new O.Cartesian3,Y=new O.Cartesian3,H=new O.Cartesian2,J=new O.Cartesian2,K=new O.Cartesian2,Q=new O.Cartesian2,$=new O.Cartesian2,aa=new O.Cartesian3,ta=new O.Cartesian3,ea=new O.Cartesian3,na=new O.Cartesian3,ra=new O.Cartesian2,ia=new O.Cartesian3,sa=new O.Cartesian3,oa=new O.Cartesian3,Ca=new N.Plane(O.Cartesian3.UNIT_X,0);T.fromRectangle=function(a,t,e,n,r){if(t=y.defaultValue(t,0),e=y.defaultValue(e,0),n=y.defaultValue(n,b.Ellipsoid.WGS84),a.width<=w.CesiumMath.PI){var i=b.Rectangle.center(a,B),s=n.cartographicToCartesian(i,_),o=new A.EllipsoidTangentPlane(s,n),C=o.plane,c=i.longitude,u=a.south<0&&0<a.north?0:i.latitude,l=O.Cartographic.fromRadians(c,a.north,e,k),d=O.Cartographic.fromRadians(a.west,a.north,e,W),h=O.Cartographic.fromRadians(a.west,u,e,D),x=O.Cartographic.fromRadians(a.west,a.south,e,q),M=O.Cartographic.fromRadians(c,a.south,e,X),m=n.cartographicToCartesian(l,j),f=n.cartographicToCartesian(d,Z),p=n.cartographicToCartesian(h,G),g=n.cartographicToCartesian(x,F),s=n.cartographicToCartesian(M,Y),i=o.projectPointToNearestOnPlane(m,H),u=o.projectPointToNearestOnPlane(f,J),c=o.projectPointToNearestOnPlane(p,K),l=o.projectPointToNearestOnPlane(g,Q),h=o.projectPointToNearestOnPlane(s,$),m=-(M=Math.min(u.x,c.x,l.x)),p=Math.max(u.y,i.y),s=Math.min(l.y,h.y);return d.height=x.height=t,f=n.cartographicToCartesian(d,Z),g=n.cartographicToCartesian(x,F),c=Math.min(N.Plane.getPointDistance(C,f),N.Plane.getPointDistance(C,g)),u=e,v(o.origin,o.xAxis,o.yAxis,o.zAxis,M,m,s,p,c,u,r)}i=0<a.south,l=a.north<0,h=i?a.south:l?a.north:0,d=b.Rectangle.center(a,B).longitude,x=O.Cartesian3.fromRadians(d,h,e,n,aa);x.z=0;f=Math.abs(x.x)<w.CesiumMath.EPSILON10&&Math.abs(x.y)<w.CesiumMath.EPSILON10?O.Cartesian3.UNIT_X:O.Cartesian3.normalize(x,ta),g=O.Cartesian3.UNIT_Z,o=O.Cartesian3.cross(f,g,ea);C=N.Plane.fromPointNormal(x,f,Ca);d=O.Cartesian3.fromRadians(d+w.CesiumMath.PI_OVER_TWO,h,e,n,na);M=-(m=O.Cartesian3.dot(N.Plane.projectPointOntoPlane(C,d,ra),o)),p=O.Cartesian3.fromRadians(0,a.north,l?t:e,n,ia).z,s=O.Cartesian3.fromRadians(0,a.south,i?t:e,n,sa).z;n=O.Cartesian3.fromRadians(a.east,h,e,n,oa);return v(x,o,g,f,M,m,s,p,c=N.Plane.getPointDistance(C,n),u=0,r)},T.clone=function(a,t){if(y.defined(a))return y.defined(t)?(O.Cartesian3.clone(a.center,t.center),P.Matrix3.clone(a.halfAxes,t.halfAxes),t):new T(a.center,a.halfAxes)},T.intersectPlane=function(a,t){var e=a.center,n=t.normal,r=a.halfAxes,i=n.x,s=n.y,a=n.z,r=Math.abs(i*r[P.Matrix3.COLUMN0ROW0]+s*r[P.Matrix3.COLUMN0ROW1]+a*r[P.Matrix3.COLUMN0ROW2])+Math.abs(i*r[P.Matrix3.COLUMN1ROW0]+s*r[P.Matrix3.COLUMN1ROW1]+a*r[P.Matrix3.COLUMN1ROW2])+Math.abs(i*r[P.Matrix3.COLUMN2ROW0]+s*r[P.Matrix3.COLUMN2ROW1]+a*r[P.Matrix3.COLUMN2ROW2]),t=O.Cartesian3.dot(n,e)+t.distance;return t<=-r?o.Intersect.OUTSIDE:r<=t?o.Intersect.INSIDE:o.Intersect.INTERSECTING};var x=new O.Cartesian3,M=new O.Cartesian3,m=new O.Cartesian3,c=new O.Cartesian3;T.distanceSquaredTo=function(a,t){var e=O.Cartesian3.subtract(t,a.center,d),n=a.halfAxes,r=P.Matrix3.getColumn(n,0,x),i=P.Matrix3.getColumn(n,1,M),s=P.Matrix3.getColumn(n,2,m),o=O.Cartesian3.magnitude(r),t=O.Cartesian3.magnitude(i),a=O.Cartesian3.magnitude(s);O.Cartesian3.normalize(r,r),O.Cartesian3.normalize(i,i),O.Cartesian3.normalize(s,s);n=c;n.x=O.Cartesian3.dot(e,r),n.y=O.Cartesian3.dot(e,i),n.z=O.Cartesian3.dot(e,s);var C,s=0;return n.x<-o?s+=(C=n.x+o)*C:n.x>o&&(s+=(C=n.x-o)*C),n.y<-t?s+=(C=n.y+t)*C:n.y>t&&(s+=(C=n.y-t)*C),n.z<-a?s+=(C=n.z+a)*C:n.z>a&&(s+=(C=n.z-a)*C),s};var f=new O.Cartesian3,p=new O.Cartesian3;T.computePlaneDistances=function(a,t,e,n){y.defined(n)||(n=new P.Interval);var r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=a.center,o=a.halfAxes,C=P.Matrix3.getColumn(o,0,x),c=P.Matrix3.getColumn(o,1,M),u=P.Matrix3.getColumn(o,2,m),l=O.Cartesian3.add(C,c,f);O.Cartesian3.add(l,u,l),O.Cartesian3.add(l,s,l);a=O.Cartesian3.subtract(l,t,p),o=O.Cartesian3.dot(e,a),r=Math.min(o,r),i=Math.max(o,i);return O.Cartesian3.add(s,C,l),O.Cartesian3.add(l,c,l),O.Cartesian3.subtract(l,u,l),O.Cartesian3.subtract(l,t,a),o=O.Cartesian3.dot(e,a),r=Math.min(o,r),i=Math.max(o,i),O.Cartesian3.add(s,C,l),O.Cartesian3.subtract(l,c,l),O.Cartesian3.add(l,u,l),O.Cartesian3.subtract(l,t,a),o=O.Cartesian3.dot(e,a),r=Math.min(o,r),i=Math.max(o,i),O.Cartesian3.add(s,C,l),O.Cartesian3.subtract(l,c,l),O.Cartesian3.subtract(l,u,l),O.Cartesian3.subtract(l,t,a),o=O.Cartesian3.dot(e,a),r=Math.min(o,r),i=Math.max(o,i),O.Cartesian3.subtract(s,C,l),O.Cartesian3.add(l,c,l),O.Cartesian3.add(l,u,l),O.Cartesian3.subtract(l,t,a),o=O.Cartesian3.dot(e,a),r=Math.min(o,r),i=Math.max(o,i),O.Cartesian3.subtract(s,C,l),O.Cartesian3.add(l,c,l),O.Cartesian3.subtract(l,u,l),O.Cartesian3.subtract(l,t,a),o=O.Cartesian3.dot(e,a),r=Math.min(o,r),i=Math.max(o,i),O.Cartesian3.subtract(s,C,l),O.Cartesian3.subtract(l,c,l),O.Cartesian3.add(l,u,l),O.Cartesian3.subtract(l,t,a),o=O.Cartesian3.dot(e,a),r=Math.min(o,r),i=Math.max(o,i),O.Cartesian3.subtract(s,C,l),O.Cartesian3.subtract(l,c,l),O.Cartesian3.subtract(l,u,l),O.Cartesian3.subtract(l,t,a),o=O.Cartesian3.dot(e,a),r=Math.min(o,r),i=Math.max(o,i),n.start=r,n.stop=i,n};var n=new o.BoundingSphere;T.isOccluded=function(a,t){a=o.BoundingSphere.fromOrientedBoundingBox(a,n);return!t.isBoundingSphereVisible(a)},T.prototype.intersectPlane=function(a){return T.intersectPlane(this,a)},T.prototype.distanceSquaredTo=function(a){return T.distanceSquaredTo(this,a)},T.prototype.computePlaneDistances=function(a,t,e){return T.computePlaneDistances(this,a,t,e)},T.prototype.isOccluded=function(a){return T.isOccluded(this,a)},T.equals=function(a,t){return a===t||y.defined(a)&&y.defined(t)&&O.Cartesian3.equals(a.center,t.center)&&P.Matrix3.equals(a.halfAxes,t.halfAxes)},T.prototype.clone=function(a){return T.clone(this,a)},T.prototype.equals=function(a){return T.equals(this,a)},a.OrientedBoundingBox=T});
